{{define "tokens_list_page"}}
<h1>Admin Tokens</h1>

<p><a href="/admin/tokens/new" style="margin-right: 1rem;">Create New Token</a></p>

{{if .Tokens}}
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Created</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {{range .Tokens}}
        <tr>
            <td>{{.ID}}</td>
            <td>{{.Name}}</td>
            <td>{{.CreatedAt.Format "2006-01-02 15:04:05"}}</td>
            <td>
                <form method="post" action="/admin/tokens/{{.ID}}/delete" style="display: inline;">
                    <button type="submit" onclick="return confirm('Are you sure you want to delete this token?');" style="background: #e74c3c; padding: 0.5rem 1rem; font-size: 0.9rem;">Delete</button>
                </form>
            </td>
        </tr>
        {{end}}
    </tbody>
</table>
{{else}}
<p><em>No tokens created yet.</em></p>
{{end}}
{{end}}

{{define "content"}}
{{if eq .Title "Admin Dashboard"}}
<h1>Admin Dashboard</h1>
<p>Welcome to the bunny-api-proxy admin panel.</p>

<h2>Quick Links</h2>
<ul>
    <li><a href="/admin/master-key">Configure Master API Key</a></li>
    <li><a href="/admin/tokens">Manage Admin Tokens</a></li>
</ul>

<h2>System Status</h2>
<ul>
    <li>Health: <a href="/admin/health" target="_blank">/admin/health</a></li>
    <li>Readiness: <a href="/admin/ready" target="_blank">/admin/ready</a></li>
</ul>
{{else if eq .Title "Master API Key"}}
<h1>Master API Key</h1>

{{if .CurrentKey}}
<div class="alert alert-info">
    Current key: <code>{{.CurrentKey}}</code>
</div>
{{else}}
<div class="alert alert-warning">
    No master key configured.
</div>
{{end}}

<form method="post" action="/admin/master-key">
    <label for="key">New Master Key:</label>
    <input type="text" id="key" name="key" required placeholder="Enter bunny.net API key">

    <button type="submit">Update Key</button>
</form>

<p><small>This key is used to communicate with bunny.net API. It is securely stored and only used by the proxy to make authenticated requests to bunny.net.</small></p>
{{else if eq .Title "Admin Tokens"}}
{{template "tokens_list_page" .}}
{{else}}
{{template "token_form_page" .}}
{{end}}
{{end}}
